# 1. 今日工作总结

1. 汇总扣款和扣费用差额接口
2. 排查数据库慢sql的问题

# 2. sql的问题

今天遇到数据慢sql，原因是没走索引，但是数据库的索引是建了的。
因为数据索引的区分度突然变成了1

```sql
show index from table
```

通过查询stack overflow 得知 innodb在数据量修改超过15%或者全局自增大于多少的时候会更新统计信息。

统计信息的区分度变成1，因为innodb随机采样的时候，有一个一样的数据，所以是1。 这块有点没看懂

然后又怀疑是不是唯一索引没用，可能随机采样的时候有两条一样的数据导致为1

也有可能是读取索引文件失败了，所以为1

后来过了半个小时左右 自动恢复了。
